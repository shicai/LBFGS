#ifndef _HIK_IPA_TPR_DAE_UTILS_H_
#define _HIK_IPA_TPR_DAE_UTILS_H_

#ifndef _HIK_IPA_TPR_DAE_GENERICS_H_
#include "cuda_generics.h"
#endif

/***********************************************************************************************************************
* 功　能:   获取是否存在GPU
* 参　数:   
* 返回值:               - O     正常返回: GPU数量, 异常返回: 0
***********************************************************************************************************************/
int get_device();

/***********************************************************************************************************************
* 功　能:   获取GPU的计算能力
* 参　数:   dev         - I     设备号(0,1,2...)
* 返回值:               - O     正常返回: 计算能力的一百倍（如计算能力3.5，返回350）, 异常返回: 0
***********************************************************************************************************************/
int get_cudacc(int dev);

/***********************************************************************************************************************
* 功　能:   计算GPU中可用的显存
* 参　数:   
* 返回值:               - O     正常返回: 显存的大小Bytes, 异常返回: 错误码
***********************************************************************************************************************/
size_t get_freemem();

/***********************************************************************************************************************
* 功　能:   计算Block的数量
* 参　数:   num         - I     数据的数量
* 返回值:               - O     Block的数量
***********************************************************************************************************************/
int calc_gridsize(int num);

/***********************************************************************************************************************
* 功　能:   计算Block和Thread的数量
* 参　数:   n           - I     数据的数量
* 　　　    blocks      - O     Block的数量
* 　　　    threads     - O     Thread的数量
* 返回值:               - O     正常返回: 0, 异常返回: 错误码或错误信息
***********************************************************************************************************************/
int calc_gridblocksize(int n, int &blocks, int &threads);

/***********************************************************************************************************************
* 功　能:   判断是否2的幂
* 参　数:   x           - I     某个整数
* 返回值:               - O     是, 返回true; 否, 返回false
***********************************************************************************************************************/
bool is_pow2(int x);

/***********************************************************************************************************************
* 功　能:   计算是2的幂的下一个整数
* 参　数:   x           - I     某个整数
* 返回值:               - O     返回所需要的整数
***********************************************************************************************************************/
unsigned int next_pow2(unsigned int x);

#endif // _HIK_IPA_TPR_DAE_UTILS_H_